for(var M=[],Y=[-1],E=0,A=1;E<255;++E)M.push(A),Y[A]=E,A=A*2^(A>=128?285:0);for(var _=[[]],E=0;E<30;++E){for(var g=_[E],i=[],T=0;T<=E;++T){var F=T<E?M[g[T]]:0,m=M[(E+(g[T-1]||0))%255];i.push(Y[F^m])}_.push(i)}var z=[(r,f)=>(r+f)%2===0,(r,f)=>r%2===0,(r,f)=>f%3===0,(r,f)=>(r+f)%3===0,(r,f)=>((r/2|0)+(f/3|0))%2===0,(r,f)=>r*f%2+r*f%3===0,(r,f)=>(r*f%2+r*f%3)%2===0,(r,f)=>((r+f)%2+r*f%3)%2===0],C=function(r,f){var t=[],v=0,n=8,e=r.length,a=function(l,h){if(h>=n){for(t.push(v|l>>(h-=n));h>=8;)t.push(l>>(h-=8)&255);v=0,n=8}h>0&&(v|=(l&(1<<h)-1)<<(n-=h))},u=8;a(4,4),a(e,u);for(var o=0;o<e;++o)a(r[o],8);for(a(0,4),n<8&&t.push(v);t.length+1<f;)t.push(236,17);return t.length<f&&t.push(236),t},G=function(r,f){for(var t=r.slice(0),v=r.length,n=f.length,e=0;e<n;++e)t.push(0);for(var e=0;e<v;){var a=Y[t[e++]];if(a>=0)for(var u=0;u<n;++u)t[e+u]^=M[(a+f[u])%255]}return t.slice(v)},O=function(r,f){for(var t=[],v=r.length/1|0,n=0,e=1-r.length%1,a=0;a<e;++a)t.push(n),n+=v;for(var a=e;a<1;++a)t.push(n),n+=v+1;t.push(n);for(var u=[],a=0;a<1;++a)u.push(G(r.slice(t[a],t[a+1]),f));for(var o=[],l=r.length/1|0,a=0;a<l;++a)for(var h=0;h<1;++h)o.push(r[t[h]+a]);for(var h=e;h<1;++h)o.push(r[t[h+1]-1]);for(var a=0;a<f.length;++a)for(var h=0;h<1;++h)o.push(u[h][a]);return o},D=function(r,f,t,v){for(var n=r<<v,e=f-1;e>=0;--e)n>>v+e&1&&(n^=t<<e);return r<<v|n},K=function(r,f){for(var t=[],v=[],n=0;n<r;++n)t.push([]),v.push([]);var e=function(a,u,o,l,h){for(var c=0;c<o;++c)for(var s=0;s<l;++s)t[a+c][u+s]=h[c]>>s&1,v[a+c][u+s]=1};e(0,0,9,9,[127,65,93,93,93,65,383,0,64]),e(r-8,0,8,9,[256,127,65,93,93,93,65,127]),e(0,r-8,9,8,[254,130,186,186,186,130,254,0,0]);for(var n=9;n<r-8;++n)t[6][n]=t[n][6]=~n&1,v[6][n]=v[n][6]=1;return e(f,f,5,5,[31,17,21,17,31]),[t,v]},U=function(r,f,t){for(var v=r.length,n=0,e=-1,a=v-1;a>=0;a-=2){a===6&&--a;for(var u=e<0?v-1:0,o=0;o<v;++o){for(var l=a;l>a-2;--l)f[u][l]||(r[u][l]=t[n>>3]>>(~n&7)&1,++n);u+=e}e=-e}return r},I=function(r,f,t){for(var v=z[t],n=r.length,e=0;e<n;++e)for(var a=0;a<n;++a)f[e][a]||(r[e][a]^=v(e,a));return r},k=function(r,f,t){for(var v=r.length,n=D(1<<3|t,5,1335,10)^21522,e=0;e<15;++e){var a=[0,1,2,3,4,5,7,8,v-7,v-6,v-5,v-4,v-3,v-2,v-1][e],u=[v-1,v-2,v-3,v-4,v-5,v-6,v-7,v-8,7,5,4,3,2,1,0][e];r[a][8]=r[8][u]=n>>e&1}return r},V=function(r){for(var f=3,t=3,v=40,n=10,e=function(b){for(var P=0,x=0;x<b.length;++x)b[x]>=5&&(P+=f+(b[x]-5));for(var x=5;x<b.length;x+=2){var N=b[x];b[x-1]===N&&b[x-2]===3*N&&b[x-3]===N&&b[x-4]===N&&(b[x-5]>=4*N||b[x+1]>=4*N)&&(P+=v)}return P},a=r.length,u=0,o=0,l=0;l<a;++l){var h=r[l],c;c=[0];for(var s=0;s<a;){var d;for(d=0;s<a&&h[s];++d)++s;for(c.push(d),d=0;s<a&&!h[s];++d)++s;c.push(d)}u+=e(c),c=[0];for(var s=0;s<a;){var d;for(d=0;s<a&&r[s][l];++d)++s;for(c.push(d),d=0;s<a&&!r[s][l];++d)++s;c.push(d)}u+=e(c);var S=r[l+1]||[];o+=h[0];for(var s=1;s<a;++s){var L=h[s];o+=L,h[s-1]===L&&S[s]===L&&S[s-1]===L&&(u+=t)}}return u+=n*(Math.abs(o/a/a-.5)/.05|0),u};const W=r=>{const f=[];for(let c=0;c<r.length;c++)f.push(r.charCodeAt(c));const[t,v,n,e]=[[25,32,10,16],[29,53,15,20],[33,78,20,24]].find(c=>f.length<=c[1]),a=O(C(f,v+2),_[n]),[u,o]=K(t,e);U(u,o,a);let l=1/0,h=0;for(let c=0;c<=7;c++){I(u,o,c),k(u,o,c);let s=V(u);l>s&&(l=s,h=c),I(u,o,c)}return I(u,o,h),k(u,o,h),u};export{W as getMatrix};
